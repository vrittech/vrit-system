{
    "sourceFile": "career/management/commands/expire_forms.py",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1730179081042,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1730179089375,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n from django.core.management.base import BaseCommand\n-from .models import Forms\n+from career.models import Career\n from datetime import date\n \n class Command(BaseCommand):\n     help = 'Mark forms as expired if the auto expiration date has passed'\n"
                }
            ],
            "date": 1730179081042,
            "name": "Commit-0",
            "content": "from django.core.management.base import BaseCommand\nfrom .models import Forms\nfrom datetime import date\n\nclass Command(BaseCommand):\n    help = 'Mark forms as expired if the auto expiration date has passed'\n\n    def handle(self, *args, **kwargs):\n        today = date.today()\n        forms_to_expire = Forms.objects.filter(\n            auto_expiration=True,\n            auto_expiration_date__lt=today,\n            is_expired=False\n        )\n\n        forms_to_expire.update(is_expired=True)\n        self.stdout.write(self.style.SUCCESS(f'{forms_to_expire.count()} forms marked as expired.'))\n\n# crontab -e\n# 0 0 * * * /path/to/your/virtualenv/bin/python /path/to/your/project/manage.py expire_forms\n# python manage.py expire_forms\n# grep CRON /var/log/syslog\n"
        }
    ]
}